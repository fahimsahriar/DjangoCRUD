{% extends 'PayRollApp/Base.html' %}

{% block title %}Employee List{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2 class="mb-4">Employee List</h2>

  <div class="d-flex justify-content-between mb-3">
    <!-- Add new employee link -->
    <a href="{% url 'AddEmployee' %}" class="">Add new employee</a>

    <!-- Bootstrap search box -->
    <form class="d-flex" method="GET" action="">
      <input
        class="form-control me-2"
        type="search"
        placeholder="Search employees"
        aria-label="Search"
        name="search"
        value="{{ search_query }}"
      />
      <button class="btn btn-outline-primary" type="submit">Search</button>
    </form>
  </div>

  <table
    class="table sortable-theme-bootstrap table-striped table-bordered"
    data-sortable
  >
    <thead class="thead-dark">
      <tr>
        <th>#</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Title</th>
        <th>Has Passport</th>
        <th>Salary</th>
        <th>Birth Date</th>
        <th>Hiring Date</th>
        <th>Notes</th>
        <th>Country</th>
        <th>Department</th>
        <th>Location</th>
        <th>Email</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for employee in employees %}
      <tr>
        <td>{{ employee.id }}</td>
        <td>{{ employee.FirstName }}</td>
        <td>{{ employee.LastName }}</td>
        <td>{{ employee.TitleName }}</td>
        <td>{{ employee.HasPassport|yesno:"Yes,No" }}</td>
        <td>{{ employee.Salary }}</td>
        <td>{{ employee.BirthDate }}</td>
        <td>{{ employee.HiringDate }}</td>
        <td>{{ employee.Notes }}</td>
        <td>{{ employee.Country.CountryName }}</td>
        <td>{{ employee.EmployeeDepartment.DepartmentName }}</td>
        <td>{{ employee.EmployeeDepartment.LocationName }}</td>
        <td>{{ employee.Email }}</td>
        <td>
          <a href="../employee/{{employee.id}}" class="">Detail</a>
          <a href="../EmployeeUpdate/{{employee.id}}" class="">Edit</a>
          <a href="../DeleteEmployee/{{employee.id}}" class="">Delete</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="14">No employees found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="pagination">
    <span class="step-links">
      {% if employees.has_previous %}
      <a href="?page=1">&laquo; first</a>
      <a href="?page={{ employees.previous_page_number }}">previous</a>
      {% endif %}

      <span class="current">
        Page {{ employees.number }} of {{ employees.paginator.num_pages }}.
      </span>

      {% if employees.has_next %}
      <a href="?page={{ employees.next_page_number }}">next</a>
      <a href="?page={{ employees.paginator.num_pages }}">last &raquo;</a>
      {% endif %}
    </span>
  </div>
</div>
{% endblock %}

<!-- Add any specific scripts for sortable functionality -->
{% block scripts %}
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/sortable/0.8.0/js/sortable.min.js"
    integrity="sha512-DEcSaL0BWApJ//v7ZfqAI04nvK+NQcUVwrrx/l1x7OJgU0Cwbq7e459NBMzLPrm8eLPzAwBtiJJS4AvLZDZ8xA=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  ></script>
{% endblock %}
